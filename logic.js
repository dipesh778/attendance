const data= [
   
    {
        S_No: 1,
        Roll_No: 211616,
        Name: "Abhay"
      },
      {
        S_No: 2,
        Roll_No: 211618,
        Name: "Aman Shandilya"
      },
      {
        S_No: 3,
        Roll_No: 211619,
        Name: "Anish Mishra"
      },
      {
        S_No: 4,
        Roll_No: 211620,
        Name: "Ayush Kumar Singh"
      },
      {
        S_No: 5,
        Roll_No: 211621,
        Name: "Brajendra Kumar"
      },
      {
        S_No: 6,
        Roll_No: 211622,
        Name: "Burugadda Naveen"
      },
      {
        S_No: 7,
        Roll_No: 211623,
        Name: "Devender"
      },
      {
        S_No: 8,
        Roll_No: 211624,
        Name: "Dipesh Kumar"
      },
      {
        S_No: 9,
        Roll_No: 211625,
        Name: "Ganeshan Yadav"
      },
      {
        S_No: 10,
        Roll_No: 211626,
        Name: "Harikrishan"
      },
      {
        S_No: 11,
        Roll_No: 211627,
        Name: "Harsh"
      },
      {
        S_No: 12,
        Roll_No: 211628,
        Name: "Harsh Aryan"
      },
      {
        S_No: 13,
        Roll_No: 211630,
        Name: "Kaushal Kumar Gupta"
      },
      {
        S_No: 14,
        Roll_No: 211632,
        Name: "Manish kumar"
      },
      {
        S_No: 15,
        Roll_No: 211633,
        Name: "Meda Janaki Venkata Ramana Rao"
      },
      {
        S_No: 16,
        Roll_No: 211634,
        Name: "Middinti Ramulu"
      },
      {
        S_No: 17,
        Roll_No: 211635,
        Name: "Mohit Dagar"
      },
      {
        S_No: 18,
        Roll_No: 211636,
        Name: "Mukul"
      },
      {
        S_No: 19,
        Roll_No: 211637,
        Name: "Neeraj Kumar"
      },
      {
        S_No: 20,
        Roll_No: 211638,
        Name: "Neha Chandra"
      },
      {
        S_No: 21,
        Roll_No: 211639,
        Name: "Nikal"
      },
      {
        S_No: 22,
        Roll_No: 211640,
        Name: "Nikhil Priyadarshi"
      },
      {
        S_No: 23,
        Roll_No: 211641,
        Name: "Nishant Kumar"
      },
      {
        S_No: 24,
        Roll_No: 211642,
        Name: "Omkumar Babasaheb Jadhav"
      },
      {
        S_No: 25,
        Roll_No: 211643,
        Name: "Prakash kumar suman"
      },
      {
        S_No: 26,
        Roll_No: 211644,
        Name: "Prashansa Priya"
      },
      {
        S_No: 27,
        Roll_No: 211645,
        Name: "Prashant Dubey"
      },
      {
        S_No: 28,
        Roll_No: 211646,
        Name: "Puppala Archana"
      },
      {
        S_No: 29,
        Roll_No: 211647,
        Name: "R Manjula"
      },
      {
        S_No: 30,
        Roll_No: 211648,
        Name: "Rahul"
      },
      {
        S_No: 31,
        Roll_No: 211651,
        Name: "Sanskar"
      },
      {
        S_No: 32,
        Roll_No: 211653,
        Name: "Sanskriti"
      },
      {
        S_No: 33,
        Roll_No: 211654,
        Name: "Sanskriti Sharma"
      },
      {
        S_No: 34,
        Roll_No: 211655,
        Name: "Saurav Kumar"
      },
      {
        S_No: 35,
        Roll_No: 211657,
        Name: "Shekhar Singh"
      },
      {
        S_No: 36,
        Roll_No: 211658,
        Name: "Soumodip Ghosh"
      },
      {
        S_No: 37,
        Roll_No: 211659,
        Name: "Suryadev Tholiya"
      },
      {
        S_No: 38,
        Roll_No: 211660,
        Name: "Tanishque Singh"
      },
      {
        S_No: 39,
        Roll_No: 211662,
        Name: "Tushar"
      },
      {
        S_No: 40,
        Roll_No: 211663,
        Name: "Tushar Sharma"
      },
      {
        S_No: 41,
        Roll_No: 211664,
        Name: "Vaibhav Verma"
      },
      {
        S_No: 42,
        Roll_No: 211665,
        Name: "Vikas Choudhary"
      },
      {
        S_No: 43,
        Roll_No: 211666,
        Name: "Vikas Ghorela"
      },
      {
        S_No: 44,
        Roll_No: 211667,
        Name: "Yewant Sharma"
      },
      {
        S_No: 45,
        Roll_No: 212595,
        Name: "Abhishek"
      },
      {
        S_No: 46,
        Roll_No: 212597,
        Name: "Ankit Kumar"
      },
      {
        S_No: 47,
        Roll_No: 212594,
        Name: "Anmol Singla"
      },
      {
        S_No: 48,
        Roll_No: 212599,
        Name: "Arti"
      },
      {
        S_No: 49,
        Roll_No: 212600,
        Name: "Bhola Kumar"
      },
      {
        S_No: 40,
        Roll_No: 212601,
        Name: "Gaurav"
      },
      {
        S_No: 51,
        Roll_No: 212602,
        Name: "Gaurav Yadav"
      },
      {
        S_No: 52,
        Roll_No: 212603,
        Name: "Jaykant Kumar"
      },
      {
        S_No: 53,
        Roll_No: 212604,
        Name: "Prachi"
      },
      {
        S_No: 54,
        Roll_No: 212605,
        Name: "Rahul Kumar"
      },
      {
        S_No: 55,
        Roll_No: 212606,
        Name: "Vinay"
      },
];
    let AttendanceTakerName
    let dateSelected
    let subjectSelected
    let detail1
    let S_No = document.getElementById('s_no');
	  let Roll_No = document.getElementById("roll");
	  let Name = document.getElementById("name");
	  const presentBtn = document.getElementById("presentBtn");
	  const absentBtn = document.getElementById("absentBtn");
    const downloadButton = document.getElementById("download-button");
    document.getElementById('dateInput').value = formatDate(new Date());

	//   console.log(Name,Roll_No);


// update data in excel
// var presentBtn = document.getElementById("presentBtn");

function formatDate(date) {
  var year = date.getFullYear();
  var month = (date.getMonth() + 1).toString().padStart(2, '0');
  var day = date.getDate().toString().padStart(2, '0');
  return year + "-" + month + "-" + day;
}

function changedate(dateSelected){
  var parts=dateSelected.split('-');
  return parts[2] + "-" + parts[1] + "-" + parts[0];
}

// animation on page1 
const text = document.getElementById("text");
const letters = text.innerText.split("");
text.innerText = "";

letters.forEach((letter, i) => {
  setTimeout(() => {
    const newSpan = document.createElement("span");
    newSpan.innerText = letter;
    text.appendChild(newSpan);
  }, i * 100);
});



let i=0;
let data1 = [
    ["S_No", " Roll_No    ", "    Name    "],
];



// load button working
function loadBtn_w(){
  console.log("yesss");
  AttendanceTakerName=document.getElementById("AttendanceTakerName").value
  dateSelected=document.getElementById("dateInput").value
  console.log(dateSelected)
  subjectSelected=document.getElementById("subjectSelected").value
  detail1=subjectSelected+"  "+changedate(dateSelected)+"  "+AttendanceTakerName
  console.log(detail1)
  document.getElementById("loadBtn").style.backgroundColor="blue"
  document.getElementById("page1").style.zIndex = "-1";
  document.getElementById("page1").style.visibility="collapse"
  document.getElementById("page3").style.zIndex = "3";
  document.getElementById("page3").style.visibility="visible"
  // load_card();
  data1 = [
    ["S_No", " Roll_No    ", "    Name    "],
];

}
// load card
function load_card(){

  S_No.innerText=data[i].S_No;
  Roll_No.innerText=data[i].Roll_No;
  Name.innerText=data[i].Name;
}


function presentBtn_w(){
    
    data1.push([data[i].S_No,data[i].Roll_No,data[i].Name]);
    i++;
    load_card();
    document.getElementById("presentBtn").style.backgroundColor= "yellow";
    
   
	
	 
	// let s_no = document.getElementById("name").innerText;
	// let roll_no = document.getElementById("roll").innerText;
	// let name = document.getElementById("city").innerText;
	

	// console.log(S_No);
	// console.log(data[1].Name);
};
function absentBtn_w(){
    
    // S_No.innerText=data[i].S_No;
    // Roll_No.innerText=data[i].Roll_No;
    // Name.innerText=data[i].Name;
    i++;
    load_card();
}


function previousBtn_w(){
    i--;
    S_No.innerText=data[i].S_No;
    Roll_No.innerText=data[i].Roll_No;
    Name.innerText=data[i].Name;
    console.log(i);

    
}
//   generate excel
  function test(){
    for(var i=1;i<data1.length;i++){
        data1[i][0]=i
    }
    data1.unshift([" "," "," "])
    data1.unshift([subjectSelected, AttendanceTakerName, changedate(dateSelected)]);
    
	  const ws = XLSX.utils.aoa_to_sheet(data1);
	  const wb = XLSX.utils.book_new();
    var sheetName = subjectSelected + changedate(dateSelected);
	  XLSX.utils.book_append_sheet(wb, ws, sheetName);
	  XLSX.writeFile(wb, "excel-sheet.xls");
	};
	




// page 3


const tableBody = document.querySelector('#tableBody');

data.forEach(item => {
  const tr = document.createElement('tr');
  tr.innerHTML = `
    <td>${item.S_No}</td>
    <td>${item.Name}</td>
    <td>${item.Roll_No}</td>
    <td>
      <button id="pBtn">Present</button>
    </td>
  `;
  tableBody.appendChild(tr);
});





// const abstButtons = document.querySelectorAll('#myTable button:first-child');
const prstButtons = document.querySelectorAll('#myTable button:last-child');


prstButtons.forEach((mark_btn, index) => {
    mark_btn.addEventListener('click', event => {
    // console.log(mark_btn.style.backgroundColor)
    if (mark_btn.style.backgroundColor == ''){
    mark_prsnt(mark_btn,index)
    }
    else if(mark_btn.style.backgroundColor == 'green'){
      console.log("C2")
      mark_absnt(mark_btn,index)
       }
    
    else if( mark_btn.style.backgroundColor == 'red'){
      // mark_btn.style.backgroundColor = 'green'
      mark_prsnt(mark_btn,index)
    }
  });
});


function mark_prsnt(mark_btn,index){
  mark_btn.style.backgroundColor = 'green';
  data1.push([data[index].S_No,data[index].Roll_No,data[index].Name]);
  data1.sort((a, b) => {
    // Skip the header row
    if (a[0] === "S_no" || b[0] === "S_no") {
      return 0;
    }
    
    // Compare "S_no" values numerically
    return a[0] - b[0];
  });
  console.log(data1)
  
}
function mark_absnt(mark_btn,index){
  mark_btn.style.backgroundColor = 'red';
  for(var i=1;i<data1.length;i++){

    if(data[index].S_No==parseInt(data1[i])){
      
      var indexToDelete = data1.findIndex(student => student[0] === parseInt(data1[i][0]));

       if (indexToDelete !== -1) {
        data1.splice(indexToDelete, 1);
        console.log('Row deleted:', data1);
        } else {
         console.log('S_no not found. No row deleted.');
         } 
         data1.sort((a, b) => {
          // Skip the header row
          if (a[0] === "S_no" || b[0] === "S_no") {
            return 0;
          }
          
          // Compare "S_no" values numerically
          return a[0] - b[0];
        });

      break
    }
   
    
    console.log("nothing found")
  }
     
}
  function markAll(){
  prstButtons.forEach((mark_btn,index)=>{
    mark_btn.style.backgroundColor = 'green';
    mark_prsnt(mark_btn,index)
  });}
  function unmarkAll(){
    prstButtons.forEach((mark_btn,index)=>{
      mark_btn.style.backgroundColor = 'yellow';
      mark_absnt(mark_btn,index)
    });
  }
  
  // to_delete=[data1[index].S_No,data1[index].Roll_No,data1[index].Name]

  // console.log([data[index].S_No,data[index].Roll_No,data[index].Name]);
  // console.log("removed attendance of : ",data1[index].S_No,data1[index].Roll_No,data1[index].Name)
  // data1 = data.filter(item => item !== to_delete);

  // data1.remove([data[index+1].S_No,data[index+1].Roll_No,data[index+1].Name]);
  


